# network-synthetic-traffic-generator
Network Synthetic Traffic Generator (NSTG)

The program extracts the behavior of any network (in a .pcap) and creates a Markov chain to replicate the traffic for as long as the user wants.

## In this README:

- [Theoretical Foundation](#theoretical-foundation)
- [Software Information](#software-information)
- [Usage](#usage)
  - [Initial setup](#initial-setup)
  - [Simulation](#simulation)
- [FAQ](#faq)
- [Author Info](#author-info)
- [References](#references)

## Theoretical Foundation

The synthetic network traffic generator (TG) software is a specialized program that replicates network behavior within predetermined parameters. It focuses on specific protocols of interest and is instrumental in constructing the CR environment.

TG play a crucial role in constructing realistic scenarios within a Cyber Range (CR). They generate simulated network traffic, emulating the behavior of real users, applications, and devices to create authentic training scenarios. Also they  can be employed to assess the performance and resilience of network infrastructure and security tools under different traffic loads and attack simulations.

Other possibility is use TG to test specific network protocols and their responses to various traffic patterns, helping to identify vulnerabilities and potential security gaps. Real network traffic, on the other hand, refers to actual traffic captured from a production network, generated by real users and devices. The key distinction between real and synthetic traffic lies in their origin and purpose. About the origin, real traffic originates from actual user activities and represents the traffic experienced in live network environments. Synthetic traffic, however, is artificially generated by software to mimic real traffic behavior. As for the purpose, it can be said that real traffic is used for monitoring and analyzing existing network performance, while synthetic traffic is employed for testing and validating network infrastructure and security measures in a controlled environment, such as a CR.

In summary, CR offer powerful training environments for personnel to develop and test their cybersecurity skills. Synthetic network TG play a crucial role in constructing realistic scenarios within these CR, enabling targeted training and assessment of network security measures. By understanding the differences between real and synthetic traffic, organizations can better assess their network's resilience and strengthen their cybersecurity defenses.


## Software Information

The program generates simulated network traffic based on a Markov chain and user-supplied parameters, using parallel processing to improve traffic generation performance.

Initial Imports:
The program starts by importing the necessary libraries, such as numpy, scapy, argparse, time, among others, which will be used to manipulate data, generate network traffic and process command line arguments.

Auxiliary Functions:
The code defines several helper functions for specific tasks, such as checking if an IP belongs to a host or server, reading pcap files, creating a Markov chain from packets in the pcap file, creating transition matrices, generating traffic, calculating wait, among others.

Main Block:
The main code is inside the if __name__ == '__main__': block. It starts by defining an argument parser using the argparse module. User-supplied arguments will determine the details of the traffic simulation.

Argument Processing:
User-supplied command-line arguments, such as duration time, host and server IP addresses, and the pcap file to read, are processed to create lists of server IPs and ports.

Creation of the Transition Matrix:
The create_markov_chain function reads the provided pcap file, analyzes the packets and creates a Markov chain that represents the different traffic states based on the protocols present in the packets.

Traffic Generation:
The markov function is used to choose the next state based on the Markov chain transition matrix. Then the generate_network_traffic function is called to generate simulated traffic based on the next chosen state. This function creates packets using scapy library for different protocols like HTTP, DHCP, DNS, NTP, ARP, ICMP and sends them using sendp function.

Introduction of Parallel Processing:
The code introduces parallel processing for generating simulated traffic. It creates a defined number of processes using the multiprocessing module. Each process runs the generate_traffic_worker function, which is responsible for generating traffic in parallel. This can improve traffic generation performance, especially when multiple CPU cores are available.

Execution of Processes in Parallel:
The created processes are started using the start() method, and then the program waits for all processes to complete using the join() method. This ensures that all processes are finished before the main program exits.

In summary, the program reads command line arguments, creates a Markov chain based on data from a pcap file, and generates simulated traffic using parallel processing to improve traffic generation efficiency. Each parallel process is responsible for generating traffic for a part of the duration specified by the user. This allows multiple instances of the traffic generation function to run concurrently, taking advantage of available CPU resources.
![ntg 0 3 0 5 drawio (1)](https://github.com/jonasvasco85/NTG_0.2.0/assets/110608847/909c87f9-bb1e-43de-ae37-11d802aef12a)


## Usage

### Initial setup

1. Clone the repository.
   
    *You can do it by running:*

    ```
    git clone https://github.com/comp-ime-eb-br/NSTG_0.2.0
    ```
    
    Be careful to copy the files from the "locales" folder in the same directory as the program.
    
2. Install Python 3 and libraries

    *If you are using pip you can do it by running:*

    ```
    pip install python3
    pip install numpy
    pip install scipy
    pip install scapy
    ```

### Simulation

1. After initial setting up, run the code:

    ```
    python3 nstg.py -t 60 --verbose --all --hosts 192.168.229.129 --server 192.168.229.130:8080 --pcap example.pcap
    ```
###Options:
-h, --help: Show the help message and exit.

--verbose: Increases the verbosity of the outputs.

--version: Shows the version of the program.

-t, --time [required]: Specifies the duration of traffic generation in seconds.

-S, --server [required]: Specifies a list of servers in the format IP:port,port,port.

-H, --host [required]: Specifies a list of host IP addresses.

-P, --pcap [required]: Read a pcap file to replicate network behavior.
2. The program will generate a Makov Chain based on the network behavior extracted from the .pcap file like the graph shown in the figure.

![markov 2](https://github.com/jonasvasco85/NTG_0.2.0/assets/110608847/32096d6f-fd7c-4db8-87a3-da0aaf8ee33e)


The traffic will be generated as shown in the graph in order to be similar to the inserted example.

![Figure_5](https://github.com/jonasvasco85/NTG_0.2.0/assets/110608847/99237a4e-4981-441e-9b36-a8044321042b)

## FAQ

#### Should I use this software as a trusted Traffic Generator?

This software is just a proof of concept (PoC) created as a technical contribution of the postgraduate work at the Academic Master's level in Systems and Computing. This indicates that it has its limitations and instabilities depending on the application scenario.

## Author Info

The software was developed in a Systems and Computer Engineer post graduation project as requirement to acquiring a master degree in these areas. The student and advisors involved are mentioned bellow, with their following contact info:

- Cel Anderson Fernandes Pereira dos Santos (Anderson@ime.eb.br)
- Cel Clayton Escouper das Chagas (escouper@ime.eb.br)
- Maj Jonas Vasconcelos Bistene (jonas.bistene@ime.eb.br)


## References

Abrahamsson H, Ahlgren B (2000) Using empirical distributions to characterize Web
client traffic and to generate synthetic traffic. In: Globecom ’00 - IEEE. Global
Telecommunications Conference. Conference Record (Cat. No.00CH37137), pp 428–
433 vol.1, https://doi.org/10.1109/GLOCOM.2000.892041
Adeleke OA, Bastin N, Gurkan D (2022) Network Traffic Generation: A Survey and
Methodology. ACM Computing Surveys 55(2):28:1–28:23. https://doi.org/10.1145/
3488375, URL https://doi.org/10.1145/3488375
Antichi G, Di Pietro A, Ficara D, et al (2008) BRUNO: A high performance traffic
generator for network processor. In: 2008 International Symposium on Performance
Evaluation of Computer and Telecommunication Systems, pp 526–533
Baezner M (2018) Cyber and Information warfare in the Ukrainian conflict. Tech. rep.,
ETH Zurich, https://doi.org/10.3929/ETHZ-B-000321570, URL http://hdl.handle.
net/20.500.11850/321570, medium: application/pdf
22Bhatia S, Schmidt D, Mohay G, et al (2014) A framework for generating realistic
traffic for Distributed Denial-of-Service attacks and Flash Events. Computers &
Security 40:95–107. https://doi.org/10.1016/j.cose.2013.11.005, URL https://www.
sciencedirect.com/science/article/pii/S0167404813001673
BRASIL (2012) Lei nº 12.737, de 30 de novembro de 2012. URL https://www.planalto.
gov.br/ccivil 03/ ato2011-2014/2012/lei/l12737.htm
Cao J, Cleveland W, Gao Y, et al (2004) Stochastic models for generating synthetic
HTTP source traffic. In: IEEE INFOCOM 2004, pp 1546–1557 vol.3, https://doi.
org/10.1109/INFCOM.2004.1354568, iSSN: 0743-166X
Cheng A (2019) PAC-GAN: Packet Generation of Network Traffic using Generative Adversarial Networks. In: 2019 IEEE 10th Annual Information Technology,
Electronics and Mobile Communication Conference (IEMCON), pp 0728–0734,
https://doi.org/10.1109/IEMCON.2019.8936224, iSSN: 2644-3163
Cheng YC, Holzle U, Cardwell N, et al (2004) Monkey See, Monkey Do: A Tool for
TCP Tracing and Replaying
Du L, He J, Li T, et al (2023) DBWE-Corbat: Background network traffic generation
using dynamic word embedding and contrastive learning for cyber range. Computers
& Security 129:103202. https://doi.org/10.1016/j.cose.2023.103202, URL https://
www.sciencedirect.com/science/article/pii/S0167404823001128
Dutta P, Ryan G, Zieba A, et al (2018) Simulated User Bots: Real Time Testing of
Insider Threat Detection Systems. In: 2018 IEEE Security and Privacy Workshops
(SPW), pp 228–236, https://doi.org/10.1109/SPW.2018.00038
Feng Wc, Goel A, Bezzaz A, et al (2003) TCPivo: a high-performance packet replay
engine. In: Proceedings of the ACM SIGCOMM workshop on Models, methods and
23tools for reproducible network research. Association for Computing Machinery, New
York, NY, USA, MoMeTools ’03, pp 57–64, https://doi.org/10.1145/944773.944783,
URL https://dl.acm.org/doi/10.1145/944773.944783
Geyer F, Schneele S, Carle G (2013) RENETO, a realistic network traffic generator
for OMNeT++/INET. In: Proceedings of the 6th International ICST Conference on
Simulation Tools and Techniques. ICST (Institute for Computer Sciences, SocialInformatics and Telecommunications Engineering), Brussels, BEL, p 73–81
Hernandez-Campos F, Jeffay K, Smith FD (2007) Modeling and generating TCP
application workloads. In: 2007 Fourth International Conference on Broadband
Communications, Networks and Systems (BROADNETS ’07), pp 280–289, https:
//doi.org/10.1109/BROADNETS.2007.4550436
Huang X, Wang X, Liu Y, et al (2023) A Distributed Traffic Replay Framework for
Network Emulation. Information 14(2):59. https://doi.org/10.3390/info14020059,
URL https://www.mdpi.com/2078-2489/14/2/59, number: 2 Publisher: Multidisciplinary Digital Publishing Institute
Jaitner M, Mattsson PA (2015) Russian Information Warfare of 2014. In: 2015 7th
International Conference on Cyber Conflict: Architectures in Cyberspace, pp 39–52,
https://doi.org/10.1109/CYCON.2015.7158467, iSSN: 2325-5374
Javali C, Revadigar G (2019) Network Web Traffic Generator for Cyber Range Exercises. In: 2019 IEEE 44th Conference on Local Computer Networks (LCN), pp
308–315, https://doi.org/10.1109/LCN44214.2019.8990880, iSSN: 0742-1303
Khayari R, Rucker M, Lehmann A, et al (2008) ParaSynTG: A parameterized
synthetic trace generator for representation of WWW traffic. pp 317–323
24Kitchenham B (2004) Procedures for Performing Systematic Reviews. Keele, UK,
Keele Univ 33
Ku CY, Lin YD, Lai YC, et al (2012) Real traffic replay over WLAN with environment emulation. In: 2012 IEEE Wireless Communications and Networking
Conference (WCNC), pp 2406–2411, https://doi.org/10.1109/WCNC.2012.6214199,
iSSN: 1558-2612
Li L, Hao Z, Zhang Y, et al (2015) Traffic Replay in Virtual Network Based
on IP-Mapping. In: Wang G, Zomaya A, Martinez G, et al (eds) Algorithms
and Architectures for Parallel Processing. Springer International Publishing,
Cham, Lecture Notes in Computer Science, pp 697–713, https://doi.org/10.1007/
978-3-319-27140-8 48
Liu H, An L, Ren J, et al (2019) An Interactive Traffic Replay Method in
a Scaled-Down Environment. IEEE Access 7:149373–149386. https://doi.org/10.
1109/ACCESS.2019.2947062, conference Name: IEEE Access
Luglio M, Quadrini M, Roseti C, et al (2023) A Flexible Web Traffic Generator for the dimensioning of a 5G backhaul in NPN. Computer Networks 221:109531. https://doi.org/10.1016/j.comnet.2022.109531, URL https://
www.sciencedirect.com/science/article/pii/S1389128622005655
Mammadov S, Mehta D, Stoner E, et al (2017) High fidelity adaptive cyber emulation.
In: 2017 IEEE Symposium Series on Computational Intelligence (SSCI), pp 1–8,
https://doi.org/10.1109/SSCI.2017.8285392
Medenou Choumanof RD, Llopis Sanchez S, Calzado Mayo VM, et al (2022) Introducing the CYSAS-S3 Dataset for Operationalizing a Mission-Oriented Cyber
Situational Awareness. Sensors 22(14):5104. https://doi.org/10.3390/s22145104,
25URL https://www.mdpi.com/1424-8220/22/14/5104, number: 14 Publisher: Multidisciplinary Digital Publishing Institute
Mishra S, Sonavane S, Gupta A (2015) Study of Traffic Generation Tools 4(6)
Mour˜ao E, Pimentel JF, Murta L, et al (2020) On the performance of hybrid search
strategies for systematic literature reviews in software engineering. Information
and Software Technology 123:106294. https://doi.org/10.1016/j.infsof.2020.106294,
URL https://www.sciencedirect.com/science/article/pii/S0950584920300446
Mozo A, Gonz´alez-Prieto Pastor A, et al (2021) Synthetic flow-based cryptomining
attack generation through Generative Adversarial Networks
Oesch S, Bridges RA, Verma M, et al (2021) D2U: Data Driven User Emulation
for the Enhancement of Cyber Testing, Training, and Data Set Generation. In:
Cyber Security Experimentation and Test Workshop. ACM, Virtual CA USA, pp
17–26, https://doi.org/10.1145/3474718.3475718, URL https://dl.acm.org/doi/10.
1145/3474718.3475718
Park M, Lee H, Kim Y, et al (2022) Design and Implementation of Multi-Cyber Range
for Cyber Training and Testing. Applied Sciences (Switzerland) 12(24). https://doi.
org/10.3390/app122412546, URL http://www.scopus.com/inward/record.url?scp=
85144906378&partnerID=8YFLogxK
Patil AG, Surve AR, Gupta AK, et al (2016) Survey of synthetic traffic generators.
In: 2016 International Conference on Inventive Computation Technologies (ICICT),
pp 1–3, https://doi.org/10.1109/INVENTIVE.2016.7823282
Patil BR, Moharir M, Mohanty PK, et al (2017) Ostinato - A Powerful Traffic Generator. In: 2017 2nd International Conference on Computational Systems
and Information Technology for Sustainable Solution (CSITSS), pp 1–5, https:
26//doi.org/10.1109/CSITSS.2017.8447596
Rossey L, Cunningham R, Fried D, et al (2002) LARIAT: Lincoln adaptable realtime information assurance testbed. In: Proceedings, IEEE Aerospace Conference,
pp 6–6, https://doi.org/10.1109/AERO.2002.1036158
Sommers J, Barford P (2004) Self-configuring network traffic generation. In: Proceedings of the 4th ACM SIGCOMM conference on Internet measurement. Association
for Computing Machinery, New York, NY, USA, IMC ’04, pp 68–81, https://doi.
org/10.1145/1028788.1028798, URL https://doi.org/10.1145/1028788.1028798
Song Y, Stolfo SJ, Jebara T (2011) Behavior-based network traffic synthesis. In: 2011
IEEE International Conference on Technologies for Homeland Security (HST), pp
338–344, https://doi.org/10.1109/THS.2011.6107893
Vishwanath KV, Vahdat A (2009) Swing: Realistic and Responsive Network Traffic
Generation. IEEE/ACM Transactions on Networking 17(3):712–725. https://doi.
org/10.1109/TNET.2009.2020830, conference Name: IEEE/ACM Transactions on
Networking
